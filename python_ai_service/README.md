# خدمة تحليل الصور بالذكاء الاصطناعي - Safe Egypt AI

نظام متقدم لتحليل الرسومات الهندسية والتحقق من الامتثال للكود المصري للحريق باستخدام تقنيات الذكاء الاصطناعي.

## المميزات الرئيسية

### 🔍 تحليل الصور المتقدم
- **اكتشاف العناصر**: كشف تلقائي لأجهزة السلامة من الحريق (أجهزة كشف الدخان، طفايات الحريق، مخارج الطوارئ، إلخ)
- **استخراج النصوص**: OCR متقدم للعربية والإنجليزية لاستخراج المعلومات من الرسومات
- **معالجة الصور**: تحسين جودة الصور، تصحيح الميل، إزالة الضوضاء

### 📋 فحص الامتثال للكود المصري
- **قواعد شاملة**: فحص شامل لقواعد الكود المصري للحريق
- **تحليل المسافات**: فحص مسافات مخارج الطوارئ والتغطية
- **تقييم المخاطر**: تحديد المناطق عالية الخطورة

### 📊 تقارير تفصيلية
- **تحليل شامل**: تقارير مفصلة بالعناصر المكتشفة والمشاكل
- **توصيات عملية**: توصيات قابلة للتنفيذ مع تقدير التكلفة والوقت
- **درجات الامتثال**: حساب دقيق لدرجة الامتثال للمعايير

## التقنيات المستخدمة

### 🤖 الذكاء الاصطناعي
- **YOLO v8**: كشف الكائنات في الوقت الفعلي
- **PaddleOCR**: استخراج النصوص من الصور
- **OpenCV**: معالجة الصور المتقدمة
- **PyTorch**: التعلم العميق

### 🛠️ الأدوات والتقنيات
- **FastAPI**: واجهة برمجة التطبيقات
- **Pydantic**: تحقق من البيانات
- **asyncio**: البرمجة غير المتزامنة
- **Redis**: التخزين المؤقت

## التثبيت والتشغيل

### متطلبات النظام
```bash
Python 3.8+
CUDA (اختياري - للسرعة)
```

### 1. تثبيت المتطلبات
```bash
pip install -r requirements.txt
```

### 2. إعداد البيئة
```bash
# نسخ ملف الإعدادات
cp config.py.example config.py

# تعديل الإعدادات حسب الحاجة
```

### 3. تشغيل الخدمة
```bash
# تشغيل مباشر
python api.py

# أو باستخدام uvicorn
uvicorn api:app --host 0.0.0.0 --port 8000 --reload
```

### 4. الوصول للخدمة
- **API**: http://localhost:8000
- **التوثيق**: http://localhost:8000/docs
- **الاختبار**: http://localhost:8000/health

## الاستخدام

### رفع صورة للتحليل
```bash
curl -X POST "http://localhost:8000/analyze" \
     -H "Content-Type: multipart/form-data" \
     -F "file=@drawing.pdf" \
     -F "building_type=commercial" \
     -F "project_title=مشروع تجاري" \
     -F "project_location=القاهرة"
```

### الحصول على حالة التحليل
```bash
curl "http://localhost:8000/analysis/{request_id}"
```

### الحصول على النتيجة
```bash
curl "http://localhost:8000/analysis/{request_id}/result"
```

### الحصول على التقرير
```bash
curl "http://localhost:8000/analysis/{request_id}/report"
```

## هيكل المشروع

```
python_ai_service/
├── api.py                 # واجهة برمجة التطبيقات
├── main_analyzer.py       # المحلل الرئيسي
├── image_processor.py     # معالج الصور
├── object_detector.py     # مكتشف العناصر
├── ocr_extractor.py       # مستخرج النصوص
├── compliance_checker.py  # فاحص الامتثال
├── models.py              # نماذج البيانات
├── config.py              # الإعدادات
├── requirements.txt       # المتطلبات
├── README.md              # هذا الملف
├── uploads/               # مجلد الرفع
├── outputs/               # مجلد النتائج
├── models/                # نماذج الذكاء الاصطناعي
└── logs/                  # ملفات السجلات
```

## API Endpoints

### 🔄 التحليل
- `POST /analyze` - بدء تحليل صورة جديدة
- `GET /analysis/{id}` - حالة التحليل
- `GET /analysis/{id}/result` - نتيجة التحليل
- `GET /analysis/{id}/report` - تقرير التحليل

### 📊 الإدارة
- `GET /analyses` - قائمة التحليلات
- `DELETE /analysis/{id}` - حذف تحليل
- `GET /statistics` - إحصائيات الخدمة
- `GET /health` - فحص صحة الخدمة

## أنواع العناصر المدعومة

### 🔥 أجهزة السلامة من الحريق
- لوحة إنذار الحريق (FACP)
- أجهزة كشف الدخان
- أجهزة كشف الحرارة
- طفايات الحريق
- خراطيم الحريق
- رشاشات الماء

### 🏗️ العناصر المعمارية
- مخارج الطوارئ
- السلالم
- المصاعد
- الجدران
- الأبواب
- النوافذ
- الغرف

## قواعد الكود المصري المدعومة

### 📏 المسافات والتغطية
- تغطية أجهزة كشف الدخان (100 م² لكل جهاز)
- تغطية طفايات الحريق (200 م² لكل طفاية)
- مسافة مخارج الطوارئ (30 متر كحد أقصى)
- عرض مخارج الطوارئ (90 سم كحد أدنى)

### 🔧 المعايير التقنية
- نظام الإنذار من الحريق
- إمكانية الوصول للأجهزة
- الإشارات والعلامات
- الصيانة والتفتيش

## التخصيص والتطوير

### إضافة قاعدة جديدة
```python
# في compliance_checker.py
new_rule = ComplianceRule(
    rule_id="rule-new",
    title="عنوان القاعدة الجديدة",
    description="وصف القاعدة",
    category="coverage",
    severity=SeverityLevel.MAJOR,
    requirement="المتطلب الجديد",
    applicable_elements=[ElementType.SMOKE_DETECTOR]
)
```

### إضافة نوع عنصر جديد
```python
# في models.py
class ElementType(str, Enum):
    NEW_ELEMENT = "new_element"
```

### تخصيص معالجة الصور
```python
# في image_processor.py
def custom_preprocessing(self, image):
    # المعالجة المخصصة
    return processed_image
```

## الأداء والتحسين

### 🚀 تحسين السرعة
- استخدام GPU إذا كان متوفراً
- التخزين المؤقت للنتائج
- معالجة متوازية للصور الكبيرة

### 📈 مراقبة الأداء
- سجلات مفصلة لكل عملية
- إحصائيات زمن المعالجة
- مراقبة استخدام الموارد

## الأمان

### 🔒 حماية البيانات
- تشفير الملفات المؤقتة
- حذف تلقائي للملفات
- التحقق من تنسيقات الملفات

### 🛡️ التحقق من الأمان
- فحص حجم الملفات
- التحقق من المحتوى
- حماية من هجمات DOS

## الدعم والمساهمة

### 🐛 الإبلاغ عن المشاكل
يرجى الإبلاغ عن أي مشاكل أو اقتراحات من خلال:
- إنشاء Issue في المستودع
- إرسال بريد إلكتروني للفريق

### 🤝 المساهمة
نرحب بالمساهمات من المطورين:
1. Fork المشروع
2. إنشاء فرع للميزة الجديدة
3. إرسال Pull Request

## الترخيص

هذا المشروع مرخص تحت رخصة MIT. راجع ملف LICENSE للتفاصيل.

## الاتصال

- **البريد الإلكتروني**: support@safeegypt.ai
- **الموقع**: https://safeegypt.ai
- **التليفون**: +20 123 456 7890

---

**Safe Egypt AI** - حماية المباني بالذكاء الاصطناعي 🏢🔥🤖
